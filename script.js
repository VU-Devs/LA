const links = {
  "Essentials": [
    { title: "VU Dashboard", url: "https://vu.nl/en/dashboard" },
    { title: "Canvas", url: "https://canvas.vu.nl/" },
    { title: "CS Hub", url: "https://cs-hub.notion.site/" },
    { title: "Study Guide", url: "https://studiegids.vu.nl/en#/" },
    { title: "VU Books", url: "https://www.vuboekhandel.nl/app/ds/dssufsea1.p?language=4&level=1&btnSearch=true&cboinsti=1"},
    { title: "Timetable", url: "https://rooster.vu.nl/schedule"},
    { title: "Academic Calender", url: "https://vu.nl/en/education/more-about/academic-calendar"},
    { title: "Reserve a study spot", url: "https://pleq.vu.nl/studyspot?building=nu-gebouw"},
    { title: "VU Library", url: "https://vu.on.worldcat.org/discovery"},

  ],

  "Lab Manuals / Course Sites": [
    { title: "Computer Networks Lab Manual", url: "https://computerscienceeducation.gitbook.io/computer-networks-lab-manual" },
    { title: "Computer Organisation Lab Manual", url: "https://computerscienceeducation.gitbook.io/co-lab-manual" },
    { title: "Machine Learning", url: "https://mlvu.github.io/"},
    { title: "Deep Learning", url: "https://dlvu.github.io/"},
    { title: "Systems Programming / CoPP (Computer Programming Project)", url: "https://vu-oofp.gitlab.io/website/" },
    { title: "Databases", url: "https://joerg.endrullis.de/databases/"},
    { title: "Prof. Joerg Endrullis's Courses", url: "https://joerg.endrullis.de/teaching/" },
  ],

  "Onboarding": [
    { title: "Studielink", url: "https://www.studielink.nl/" },
    { title: "Student Immigration", url: "http://studentimmigration.vu.nl/" },
    { title: "An INCREDIBLE guide to VUreaucracy", url: "https://docs.google.com/document/d/1tlq0PJ7KAgUN11uV7hgOcO0rMDJ_nasxr5bIWWgsNwM/edit?tab=t.0#heading=h.iq2z1epx4wdu"},
    { title: "Housing guide", url: "https://docs.google.com/document/d/1ozPf7sfI6Auh0GI2xT_g7csGCrKKj4tCFkUJP1WMfyI/edit?tab=t.0"},
    { title: "Unofficial Y1 TU Delft Incoming Guidance", url: "https://docs.google.com/document/d/1y9kRZ5H1UIEsEbEe1jOKZiS72GPqX-wa3Na4-3uMb4E/edit?tab=t.y13v59u66kpb#heading=h.cjd47meacr5n" },
    { title: "VU / CS / AMS Guide by Applesauce", url: "https://csdiscdocs.gitbook.io/vu-cs-amst-guide"},
    { title: "Github Education Pack", url: "https://education.github.com/pack"},
    { title: "Bachelor Introduction Days", url:"https://vu.nl/en/education/more-about/get-your-studies-off-to-a-great-start-by-joining-the-vu-introduction-days"},
    { title: "VU Bookstore (Reading list)", url: "https://www.vuboekhandel.nl/app/stuver.p?language=4"},
    { title: "Tutiton Fees", url: "https://vu.nl/en/education/more-about/payment-of-tuition-fees-at-vu-amsterdam"},
  ],

  "GitHub / GitLab / Orgs": [
    { title: "AtLarge CO/CN Github", url: "https://github.com/ComputerScienceEducation" },
    { title: "VU IVM Github", url: "https://github.com/VU-IVM" },
    { title: "Machine Learning @ VU Github", url: "https://github.com/mlvu"},
    { title: "Deep Learning @ VU", url: "https://github.com/dlvu"},
    { title: "VU Programming Github", url: "https://github.com/VU-Programming" },
    { title: "VU StudSec Github", url: "https://github.com/StudSec/"},
    { title: "VU HPDC (High Performance Distributed Computing)", url:"https://www.vuhpdc.net/"},
    { title: "VU Studsec (Student Security)", url: "https://studsec.nl/"},
    { title: "VU Sec (Systems and Network Security Group)", url: "https://www.vusec.net/"},
    { title: "CoPP (Computer Programming Project) and OOFP (Object-oriented and Functional programming)", url: "https://gitlab.com/vu-oofp"}
  ],

  "Socials / Groups": [
    { title: "VU Reddit", url: "https://www.reddit.com/r/VUAmsterdam/" },
    { title: "VU CS Discord", url: "https://discord.gg/MGG72qsKrn"},
    { title: "2025 CS Whatssap Group", url: "https://chat.whatsapp.com/HfHTgsechBVCP0xEO1Ez8g" },
    { title: "SRVU Studentenbond",  url:"https://srvu.org/en/homepage/"},
    { title: "Icarus (Philosophy Student Club)", url: "https://www.instagram.com/vu.icarus/" },
    { title: "VU Pride", url: "https://linktr.ee/VUpride" },
    { title: "NDSA (Neurodiverse Student Association)", url: "https://linktr.ee/nd.sa" },
    { title: "Boosted Griffins (Gaming Group)", url: "https://www.instagram.com/boostedgryffins/" },
    { title: "Minescie (Minecraft)", url: "https://linktr.ee/minescie" },
    { title: "3D - VU (Gaming Discord)", url: "https://discord.gg/Ymae4vZ22s"},
    { title: "StudSec Discord", url: "https://url.studsec.nl/discord" },
  ],

  "Lectures": [
    { title: "Pervasive Computing 2021", url: "https://www.youtube.com/playlist?list=PLDPQ0iP4MFwoFLNbdDAT845-pY5VNbNbf" },
    { title: "Computer Networks 2021-2022", url: "https://www.youtube.com/playlist?list=PLAG9l-FNroVriSKJZH6Loo_hxQRr6PGRo" },
    { title: "Secure Programming 2022", url: "https://www.youtube.com/playlist?list=PLDPQ0iP4MFwpIKNDwGJwGrbboSQ7s6_TX"},
    { title: "Advanced Networks Programming 2022", url: "https://www.youtube.com/playlist?list=PLDPQ0iP4MFwp4u1BbRfjAqOPf85x-NIFL"},
    { title: "History of Science", url: "https://www.youtube.com/playlist?list=PLDPQ0iP4MFwpZpQjZ8K5QxywsKqp0OzsP"},
    { title: "Object Oriented Funcional Programming", url: "https://www.youtube.com/playlist?list=PLi-VVX8q87FL9tRKOmkCKitubGyr4OdYR" },
    { title: "Automata Theory Course", url: "https://www.youtube.com/playlist?list=PL3TE2CsKK478cNgQa7UTnEdFkXzii5CII"},
    { title: "Compiler Construction", url: "https://www.youtube.com/playlist?list=PLDPQ0iP4MFwonksLKVQwHMF8cJ1FSXyy2"},
    { title: "Networks and Graphs Lectures", url: "https://drive.google.com/drive/folders/1kYJ9NvsZ7u0vRu4o4KhAH5ocGqexYj16"},
    { title: "[Masters] Transformers Lecture 12 ", url: "https://www.youtube.com/playlist?list=PLIXJ-Sacf8u60G1TwcznBmK6rEL3gmZmV"},
    { title: "[External] Theory of Computation and Automata", url: "https://youtube.com/playlist?list=PLBlnK6fEyqRgp46KUv4ZY69yXmpwKOIev&si=y3dGXp0kHO0W5god"},
    { title: "[External] Databases", url: "https://www.youtube.com/playlist?list=PL3TE2CsKK478JNAXYLD_hzQFx5JE360KO"},
    { title: "[External] The Art of Multiprocessor programming", url: "https://www.youtube.com/playlist?list=PLbsY-4I8oat9o7p4re3308L4uk0YJe8ez"},
    { title: "[External Category Theory]", url: "https://www.youtube.com/playlist?app=desktop&list=PLbgaMIhjbmEnaH_LTkxLI7FMa2HsnawM_"},
    { title: "[External] Linear Algebra Organic Chem Tutor", url: "https://www.youtube.com/playlist?list=PLDDGPdw7e6AjJacaEe9awozSaOou-NIx_"},
    { title: "[External] Intro to x86 Assembly", url: "https://youtube.com/playlist?list=PLmxT2pVYo5LB5EzTPZGfFN0c2GDiSXgQe"},

  ],

  "Archived": [
    { title: "Storage Systems Slides (No longer taught)", url: "https://drive.google.com/drive/folders/1Ob994kg2UBFdrdgeEAReNILmCx7mSlxT" },
    { title: "Object Oriented Functional Programming Kickoff", url: "https://docs.google.com/presentation/d/1fPS0RPnBqtMI9V6HB5G6yh0KsiyCC9kWCKRe8b-500U/edit?slide=id.g2fad02caa80_45_0#slide=id.g2fad02caa80_45_0"},
    { title: "Computer Networks 2023-2024", url: "https://computer-networks-lab.gitbook.io/computer-networks-lab-manual/assignments/dns" },
  ],

  "Misc": [
    { title: "VU Link Aggregator", url: "https://vu-devs.github.io/LA/"},
    { title: "VU Services Uptime", url: "https://stats.uptimerobot.com/1QklV7XO7U" },
    { title: "Books", url: "https://drive.google.com/drive/folders/1-mRDM9CoQKjDGkRMUBlgEsw7lgkex49v"},
    { title: "VU Magazine", url: "https://advalvas.vu.nl/"},
    { title: "Theft Infographic", url: "https://assets-us-01.kc-usercontent.com/d8b6f1f5-816c-005b-1dc1-e363dd7ce9a5/4a68800b-0674-4e82-bcd5-0d6853129e9f/Folder_Diefstal_ENG_tcm270-868120.pdf"},
    { title: "VU Events", url: "https://vu.nl/en/events"},
    { title: "Library Availability", url: "https://vu-amsterdam.im-motion.net/"},
    { title: "VU Thesis Search", url: "https://vu.nl/en/about-vu/divisions/university-library/more-about/uploading-your-thesis"},
    { title: "International Collegiate Programming Contest", url: "https://icpc.global/"},
    { title: "Northwestern Europe Regional Contest", url: "https://nwerc.eu"},
    { title: "Benelux Algorithm Programming Contest", url: "https://bapc.eu"},
    { title: "German Collegiate Programming Contest 2025", url:"https://gcpc.nwerc.eu"},

  ],
};

const FAVORITE_KEY = "favoritedLinks";
let favorites = JSON.parse(localStorage.getItem(FAVORITE_KEY)) || [];

function saveFavorites() {
  localStorage.setItem(FAVORITE_KEY, JSON.stringify(favorites));
}

function isFavorited(url) {
  return favorites.includes(url);
}

function toggleFavorite(url) {
  if (isFavorited(url)) {
    favorites = favorites.filter((fav) => fav !== url);
  } else {
    favorites.push(url);
  }
  saveFavorites();
  renderAll(document.getElementById("search").value.toLowerCase());
}

function createLinkElement(link) {
  const div = document.createElement("div");
  div.className = "link-item";

  const a = document.createElement("a");
  a.href = link.url;
  a.target = "_blank";
  a.textContent = link.title;

  const star = document.createElement("button");
  star.innerHTML = "â˜…";
  star.className = "star-button";
  if (isFavorited(link.url)) star.classList.add("favorited");

  star.onclick = () => toggleFavorite(link.url);

  div.appendChild(a);
  div.appendChild(star);

  return div;
}

function renderSection(name, linksArray, filter) {
  const section = document.createElement("section");
  const title = document.createElement("h2");
  title.textContent = name;
  const list = document.createElement("div");
  list.className = "link-list";

  linksArray
    .filter(
      (link) =>
        link.title.toLowerCase().includes(filter) ||
        link.url.toLowerCase().includes(filter)
    )
    .forEach((link) => list.appendChild(createLinkElement(link)));

  section.appendChild(title);
  section.appendChild(list);
  return section;
}

function renderAll(filter = "") {
  const allLinks = Object.values(links).flat();
  const favLinks = allLinks.filter((link) => isFavorited(link.url));
  const favoritesContainer = document.getElementById("favorites");
  const sectionsContainer = document.getElementById("sections");

  favoritesContainer.innerHTML = "";
  sectionsContainer.innerHTML = "";

  if (favLinks.length > 0) {
    const favSection = renderSection("Favorites", favLinks, filter);
    favSection.querySelector(".link-list").classList.add("favorites-grid");
    favoritesContainer.appendChild(favSection);
  }

  for (const [name, list] of Object.entries(links)) {
    const filteredList = list.filter(
      (link) =>
        link.title.toLowerCase().includes(filter) ||
        link.url.toLowerCase().includes(filter)
    );
    if (filteredList.length > 0) {
      sectionsContainer.appendChild(renderSection(name, filteredList, filter));
    }
  }
}

document
  .getElementById("search")
  .addEventListener("input", (e) =>
    renderAll(e.target.value.toLowerCase())
  );

renderAll();
